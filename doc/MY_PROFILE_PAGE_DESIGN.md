# 我的主页功能设计文档

## 1. 功能概述

"我的主页"是用户个人中心，用于展示和管理用户创建的内容。页面包含三个可切换的页签：
- **事件页签**：展示用户创建的所有事件，支持管理操作
- **时间轴页签**：展示用户创建的所有时间轴，支持管理操作
- **收藏夹页签**：展示用户创建的收藏夹，支持创建新收藏夹和收藏事件

## 2. 页面布局

### 2.1 整体结构
- 页面顶部：用户头像、用户名和基本统计信息（如事件总数、时间轴总数、收藏夹总数）
- 中间部分：三个可切换的页签导航
- 内容区域：根据选中的页签展示相应内容列表

### 2.2 页签设计
- 采用横向Tab设计，支持点击切换
- 激活状态的Tab有明显视觉区分
- 移动端适配为可滚动的横向Tab或下拉菜单

## 3. 功能详情

### 3.1 事件页签
- 展示用户创建的所有事件列表
- 每个事件以卡片形式展示，包含标题、缩略图、创建时间等信息
- 支持事件的编辑和删除操作
- 支持按创建时间、标题等排序
- 支持事件搜索功能

### 3.2 时间轴页签
- 展示用户创建的所有时间轴列表
- 每个时间轴以卡片形式展示，包含标题、描述、事件数量等信息
- 支持时间轴的编辑和删除操作
- 支持按创建时间、标题等排序
- 支持时间轴搜索功能

### 3.3 收藏夹页签
- 展示用户创建的所有收藏夹列表
- 提供"创建新收藏夹"按钮
- 每个收藏夹展示收藏夹名称、描述、收藏事件数量
- 支持收藏夹的编辑和删除操作
- 点击收藏夹可查看其中收藏的事件列表
- 支持从收藏夹中移除事件

## 4. 数据模型扩展

基于现有系统，需要添加以下新表来支持收藏夹功能：

### 4.1 Collection 表（收藏夹表）
- **字段**：
  - `id` (主键)
  - `name` (收藏夹名称)
  - `description` (收藏夹描述)
  - `userId` (创建者用户ID，外键关联User表)
  - `createdAt` (创建时间)
  - `updatedAt` (更新时间)

### 4.2 CollectionEvent 表（收藏夹事件关联表）
- **字段**：
  - `id` (主键)
  - `collectionId` (收藏夹ID，外键关联Collection表)
  - `eventId` (事件ID，外键关联Event表)
  - `createdAt` (创建时间)
  - `updatedAt` (更新时间)

## 5. API 设计
### 5.1 事件管理API

#### GET /api/user/events
- **功能**: 获取当前用户创建的事件列表
- **参数**: 可选的分页、排序和搜索参数
- **返回**: 用户事件列表数据

#### DELETE /api/user/events/[id]
- **功能**: 删除用户创建的事件
- **返回**: 成功删除的确认信息

### 5.2 时间轴管理API
#### GET /api/user/timelines
- **功能**: 获取当前用户创建的时间轴列表
- **参数**: 可选的分页、排序和搜索参数
- **返回**: 用户时间轴列表数据

#### DELETE /api/user/timelines/[id]
- **功能**: 删除用户创建的时间轴
- **返回**: 成功删除的确认信息

### 5.3 收藏夹管理API
#### GET /api/user/collections
- **功能**: 获取当前用户的收藏夹列表
- **返回**: 收藏夹列表数据

#### POST /api/user/collections
- **功能**: 创建新收藏夹
- **参数**: 收藏夹名称、描述
- **返回**: 创建成功的收藏夹数据

#### PUT /api/user/collections/[id]
- **功能**: 更新收藏夹信息
- **参数**: 要更新的收藏夹信息
- **返回**: 更新后的收藏夹数据

#### DELETE /api/user/collections/[id]
- **功能**: 删除收藏夹
- **返回**: 成功删除的确认信息

#### GET /api/user/collections/[id]/events
- **功能**: 获取收藏夹中的事件列表
- **返回**: 事件列表数据

#### POST /api/user/collections/[id]/events
- **功能**: 向收藏夹添加事件
- **参数**: 事件ID
- **返回**: 更新后的收藏夹事件列表

#### DELETE /api/user/collections/[id]/events/[eventId]
- **功能**: 从收藏夹移除事件
- **返回**: 更新后的收藏夹事件列表

## 6. 组件设计

### 6.1 ProfilePage 组件
- **作用**: 我的主页容器组件
- **主要功能**: 
  - 管理页签状态
  - 渲染页签导航
  - 根据选中的页签渲染对应内容组件

### 6.2 UserStats 组件
- **作用**: 展示用户基本统计信息
- **主要功能**: 
  - 显示用户头像和名称
  - 展示事件、时间轴、收藏夹数量统计

### 6.3 TabNavigation 组件
- **作用**: 页签导航组件
- **主要功能**: 
  - 渲染三个页签（事件、时间轴、收藏夹）
  - 处理页签切换逻辑
  - 响应式适配

### 6.4 MyEventsList 组件
- **作用**: 展示用户事件列表
- **主要功能**: 
  - 从API获取用户事件数据
  - 渲染事件卡片列表
  - 处理事件排序和搜索
  - 提供事件管理功能

### 6.5 MyTimelinesList 组件
- **作用**: 展示用户时间轴列表
- **主要功能**: 
  - 从API获取用户时间轴数据
  - 渲染时间轴卡片列表
  - 处理时间轴排序和搜索
  - 提供时间轴管理功能

### 6.6 MyCollectionsList 组件
- **作用**: 展示用户收藏夹列表
- **主要功能**: 
  - 从API获取用户收藏夹数据
  - 渲染收藏夹卡片列表
  - 提供创建收藏夹功能
  - 处理收藏夹管理功能

### 6.7 CollectionDetail 组件
- **作用**: 展示单个收藏夹详情和其中的事件
- **主要功能**: 
  - 显示收藏夹基本信息
  - 渲染收藏夹中的事件列表
  - 提供从收藏夹移除事件的功能

### 6.8 CreateCollectionForm 组件
- **作用**: 创建新收藏夹的表单组件
- **主要功能**: 
  - 表单字段验证
  - 提交新收藏夹数据
  - 处理表单提交结果

## 7. 国际化支持

为"我的主页"功能添加国际化支持，需要在i18n目录下创建相关翻译文件：

- `i18n/messages/pages/MyProfilePage.en.json`
- `i18n/messages/pages/MyProfilePage.zh.json`

并在`i18n/request.ts`中导出这些翻译资源。

## 8. 交互设计

### 8.1 页面切换交互
- 页签点击时平滑切换内容区域
- 内容区域切换时添加淡入淡出过渡效果
- 支持通过URL参数直接访问特定页签

### 8.2 列表交互
- 列表项悬停效果
- 列表项点击跳转到详情页
- 操作按钮（编辑、删除）在悬停时显示

### 8.3 收藏夹操作交互
- 创建收藏夹时显示模态弹窗
- 添加/移除事件有成功反馈
- 删除操作前显示确认对话框

## 9. 响应式设计

### 9.1 桌面端布局
- 三列布局：用户信息、页签导航、内容区域并排显示
- 内容区域采用卡片网格布局

### 9.2 平板端布局
- 两列布局：用户信息和页签导航在顶部，内容区域在下方
- 内容区域采用卡片网格布局，减少每行卡片数量

### 9.3 移动端布局
- 单列布局：用户信息、页签导航、内容区域垂直排列
- 页签导航可水平滚动或折叠为下拉菜单
- 内容区域采用单列卡片布局

## 10. 性能优化

### 10.1 数据加载优化
- 实现分页加载，避免一次性加载过多数据
- 实现虚拟滚动，优化长列表渲染性能
- 添加加载状态指示器，提升用户体验

### 10.2 缓存策略
- 缓存用户数据和内容列表
- 实现乐观更新，提升交互响应速度
- 使用增量更新，减少不必要的数据传输

## 11. 后续优化方向

### 11.1 高级功能规划
- 添加内容分类和标签管理
- 实现内容导出功能
- 添加数据分析和可视化
- 支持批量操作和管理

### 11.2 用户体验优化
- 添加拖拽排序功能
- 实现主题切换
- 提供个性化设置选项
- 添加键盘快捷键支持

---

## 版本说明

**我的主页功能 1.0版本**：专注于核心功能实现，包括用户事件、时间轴和收藏夹的展示与管理，提供良好的用户体验和响应式设计。后续版本将基于用户反馈和使用数据进行迭代优化，逐步添加更多高级功能。